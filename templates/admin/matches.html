{% extends 'admin/base.html' %}

{% block title %}Matches - Admin Panel{% endblock %}
{% block page_title %}Matches{% endblock %}

{% block content %}
<div class="admin-page">
    <div class="page-header">
        <h2>Manage Matches</h2>
        <div class="header-buttons">
            <button class="btn btn-danger" id="clearMatchesBtn" onclick="clearAllMatches()">Clear All Matches</button>
            <button class="btn btn-primary">Add Match</button>
        </div>
    </div>
    
    <div class="matches-stats" style="margin-bottom: 20px; padding: 15px; background: #f5f5f5; border-radius: 8px;">
        <p><strong>Total Matches:</strong> {{ matches|length }}</p>
    </div>
    
    {% if matches %}
    <div class="matches-list">
        {% for match in matches %}
        <div class="match-card" style="background: white; padding: 15px; margin-bottom: 10px; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <strong>{{ match.team1_name }} vs {{ match.team2_name }}</strong>
                    <p style="margin: 5px 0; color: #666;">{{ match.match_format }} â€¢ {{ match.venue or 'TBD' }}</p>
                    <p style="margin: 0; font-size: 14px;">{{ match.team1_score }} - {{ match.team2_score }}</p>
                </div>
                <div style="text-align: right;">
                    <span style="color: green; font-size: 14px;">{{ match.result or 'TBD' }}</span>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="content-placeholder">
        <p>No matches available</p>
    </div>
    {% endif %}
</div>

<script>
function clearAllMatches() {
    if (confirm('Are you sure you want to delete all matches? This cannot be undone.')) {
        const btn = document.getElementById('clearMatchesBtn');
        btn.disabled = true;
        btn.textContent = 'Clearing...';
        
        fetch('/api/matches/clear', { method: 'POST' })
            .then(r => r.json())
            .then(data => {
                if (data.success) {
                    alert(data.message);
                    location.reload();
                } else {
                    alert('Error: ' + data.message);
                    btn.disabled = false;
                    btn.textContent = 'Clear All Matches';
                }
            })
            .catch(e => {
                alert('Error: ' + e);
                btn.disabled = false;
                btn.textContent = 'Clear All Matches';
            });
    }
}
</script>
{% endblock %}
