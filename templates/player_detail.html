{% extends 'base.html' %}

{% block title %}{{ player.name }} - CricLive{% endblock %}

{% block content %}
<section class="player-detail-page">
    <div class="page-header">
        <a href="/team/{{ player.team.id }}" class="back-link">&larr; Back to {{ player.team.name }}</a>
    </div>
    
    <div class="player-profile">
        <div class="player-profile-header">
            <div class="player-photo-large">
                {% if player.photo_url %}
                <img src="{{ player.photo_url }}" alt="{{ player.name }}" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                <div class="photo-placeholder-large" style="display:none;">{{ player.name[0] }}</div>
                {% else %}
                <div class="photo-placeholder-large">{{ player.name[0] }}</div>
                {% endif %}
            </div>
            <div class="player-profile-info">
                <h1 class="player-profile-name">{{ player.name }}</h1>
                {% if player.role %}
                <span class="player-profile-role">{{ player.role }}</span>
                {% endif %}
                <div class="player-team-info">
                    <div class="team-badge">
                        {% if player.team.flag_url %}
                        <img src="{{ player.team.flag_url }}" alt="{{ player.team.name }}">
                        {% endif %}
                        <span>{{ player.team.name }}</span>
                    </div>
                    <span class="team-category">{{ player.team.category.name }}</span>
                </div>
            </div>
        </div>
        
        <div class="player-details-card">
            <h3>Personal Information</h3>
            <div class="info-grid">
                {% if player.born %}
                <div class="info-item">
                    <span class="info-label">Born</span>
                    <span class="info-value">{{ player.born }}</span>
                </div>
                {% endif %}
                {% if player.birth_place %}
                <div class="info-item">
                    <span class="info-label">Birth Place</span>
                    <span class="info-value">{{ player.birth_place }}</span>
                </div>
                {% endif %}
                {% if player.nickname %}
                <div class="info-item">
                    <span class="info-label">Nickname</span>
                    <span class="info-value">{{ player.nickname }}</span>
                </div>
                {% endif %}
                {% if player.role %}
                <div class="info-item">
                    <span class="info-label">Role</span>
                    <span class="info-value">{{ player.role }}</span>
                </div>
                {% endif %}
                {% if player.batting_style %}
                <div class="info-item">
                    <span class="info-label">Batting Style</span>
                    <span class="info-value">{{ player.batting_style }}</span>
                </div>
                {% endif %}
                {% if player.bowling_style %}
                <div class="info-item">
                    <span class="info-label">Bowling Style</span>
                    <span class="info-value">{{ player.bowling_style }}</span>
                </div>
                {% endif %}
                <div class="info-item">
                    <span class="info-label">Team</span>
                    <span class="info-value">{{ player.team.name }}</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Category</span>
                    <span class="info-value">{{ player.team.category.name }}</span>
                </div>
            </div>
        </div>
        
        {% if player.batting_stats %}
        {% set bat = player.batting_stats %}
        {% if bat.test or bat.odi or bat.t20 or bat.ipl %}
        <div class="player-stats-card">
            <h3>Batting Career</h3>
            <div class="stats-table-wrapper">
                <table class="format-stats-table">
                    <thead>
                        <tr>
                            <th></th>
                            <th>TEST</th>
                            <th>ODI</th>
                            <th>T20</th>
                            <th>IPL</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="stat-label">Matches</td>
                            <td>{{ bat.test.matches or '-' }}</td>
                            <td>{{ bat.odi.matches or '-' }}</td>
                            <td>{{ bat.t20.matches or '-' }}</td>
                            <td>{{ bat.ipl.matches or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Innings</td>
                            <td>{{ bat.test.innings or '-' }}</td>
                            <td>{{ bat.odi.innings or '-' }}</td>
                            <td>{{ bat.t20.innings or '-' }}</td>
                            <td>{{ bat.ipl.innings or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Runs</td>
                            <td>{{ bat.test.runs or '-' }}</td>
                            <td>{{ bat.odi.runs or '-' }}</td>
                            <td>{{ bat.t20.runs or '-' }}</td>
                            <td>{{ bat.ipl.runs or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Balls</td>
                            <td>{{ bat.test.balls or '-' }}</td>
                            <td>{{ bat.odi.balls or '-' }}</td>
                            <td>{{ bat.t20.balls or '-' }}</td>
                            <td>{{ bat.ipl.balls or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Highest</td>
                            <td>{{ bat.test.highest or '-' }}</td>
                            <td>{{ bat.odi.highest or '-' }}</td>
                            <td>{{ bat.t20.highest or '-' }}</td>
                            <td>{{ bat.ipl.highest or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Average</td>
                            <td>{{ bat.test.average or '-' }}</td>
                            <td>{{ bat.odi.average or '-' }}</td>
                            <td>{{ bat.t20.average or '-' }}</td>
                            <td>{{ bat.ipl.average or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Strike Rate</td>
                            <td>{{ bat.test['strike rate'] or '-' }}</td>
                            <td>{{ bat.odi['strike rate'] or '-' }}</td>
                            <td>{{ bat.t20['strike rate'] or '-' }}</td>
                            <td>{{ bat.ipl['strike rate'] or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Not Outs</td>
                            <td>{{ bat.test['not outs'] or '-' }}</td>
                            <td>{{ bat.odi['not outs'] or '-' }}</td>
                            <td>{{ bat.t20['not outs'] or '-' }}</td>
                            <td>{{ bat.ipl['not outs'] or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">4s</td>
                            <td>{{ bat.test['4s'] or '-' }}</td>
                            <td>{{ bat.odi['4s'] or '-' }}</td>
                            <td>{{ bat.t20['4s'] or '-' }}</td>
                            <td>{{ bat.ipl['4s'] or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">6s</td>
                            <td>{{ bat.test['6s'] or '-' }}</td>
                            <td>{{ bat.odi['6s'] or '-' }}</td>
                            <td>{{ bat.t20['6s'] or '-' }}</td>
                            <td>{{ bat.ipl['6s'] or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Ducks</td>
                            <td>{{ bat.test.ducks or '-' }}</td>
                            <td>{{ bat.odi.ducks or '-' }}</td>
                            <td>{{ bat.t20.ducks or '-' }}</td>
                            <td>{{ bat.ipl.ducks or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">50s</td>
                            <td>{{ bat.test['50s'] or '-' }}</td>
                            <td>{{ bat.odi['50s'] or '-' }}</td>
                            <td>{{ bat.t20['50s'] or '-' }}</td>
                            <td>{{ bat.ipl['50s'] or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">100s</td>
                            <td>{{ bat.test['100s'] or '-' }}</td>
                            <td>{{ bat.odi['100s'] or '-' }}</td>
                            <td>{{ bat.t20['100s'] or '-' }}</td>
                            <td>{{ bat.ipl['100s'] or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">200s</td>
                            <td>{{ bat.test['200s'] or '-' }}</td>
                            <td>{{ bat.odi['200s'] or '-' }}</td>
                            <td>{{ bat.t20['200s'] or '-' }}</td>
                            <td>{{ bat.ipl['200s'] or '-' }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        {% endif %}
        {% endif %}
        
        {% if player.bowling_stats %}
        {% set bowl = player.bowling_stats %}
        {% if bowl.test or bowl.odi or bowl.t20 or bowl.ipl %}
        <div class="player-stats-card">
            <h3>Bowling Career</h3>
            <div class="stats-table-wrapper">
                <table class="format-stats-table">
                    <thead>
                        <tr>
                            <th></th>
                            <th>TEST</th>
                            <th>ODI</th>
                            <th>T20</th>
                            <th>IPL</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="stat-label">Matches</td>
                            <td>{{ bowl.test.matches or '-' }}</td>
                            <td>{{ bowl.odi.matches or '-' }}</td>
                            <td>{{ bowl.t20.matches or '-' }}</td>
                            <td>{{ bowl.ipl.matches or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Innings</td>
                            <td>{{ bowl.test.innings or '-' }}</td>
                            <td>{{ bowl.odi.innings or '-' }}</td>
                            <td>{{ bowl.t20.innings or '-' }}</td>
                            <td>{{ bowl.ipl.innings or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Balls</td>
                            <td>{{ bowl.test.balls or '-' }}</td>
                            <td>{{ bowl.odi.balls or '-' }}</td>
                            <td>{{ bowl.t20.balls or '-' }}</td>
                            <td>{{ bowl.ipl.balls or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Runs</td>
                            <td>{{ bowl.test.runs or '-' }}</td>
                            <td>{{ bowl.odi.runs or '-' }}</td>
                            <td>{{ bowl.t20.runs or '-' }}</td>
                            <td>{{ bowl.ipl.runs or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Maidens</td>
                            <td>{{ bowl.test.maidens or '-' }}</td>
                            <td>{{ bowl.odi.maidens or '-' }}</td>
                            <td>{{ bowl.t20.maidens or '-' }}</td>
                            <td>{{ bowl.ipl.maidens or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Wickets</td>
                            <td>{{ bowl.test.wickets or '-' }}</td>
                            <td>{{ bowl.odi.wickets or '-' }}</td>
                            <td>{{ bowl.t20.wickets or '-' }}</td>
                            <td>{{ bowl.ipl.wickets or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Average</td>
                            <td>{{ bowl.test.average or '-' }}</td>
                            <td>{{ bowl.odi.average or '-' }}</td>
                            <td>{{ bowl.t20.average or '-' }}</td>
                            <td>{{ bowl.ipl.average or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Economy</td>
                            <td>{{ bowl.test.economy or '-' }}</td>
                            <td>{{ bowl.odi.economy or '-' }}</td>
                            <td>{{ bowl.t20.economy or '-' }}</td>
                            <td>{{ bowl.ipl.economy or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Strike Rate</td>
                            <td>{{ bowl.test['strike rate'] or '-' }}</td>
                            <td>{{ bowl.odi['strike rate'] or '-' }}</td>
                            <td>{{ bowl.t20['strike rate'] or '-' }}</td>
                            <td>{{ bowl.ipl['strike rate'] or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">BBI</td>
                            <td>{{ bowl.test.bbi or '-' }}</td>
                            <td>{{ bowl.odi.bbi or '-' }}</td>
                            <td>{{ bowl.t20.bbi or '-' }}</td>
                            <td>{{ bowl.ipl.bbi or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">BBM</td>
                            <td>{{ bowl.test.bbm or '-' }}</td>
                            <td>{{ bowl.odi.bbm or '-' }}</td>
                            <td>{{ bowl.t20.bbm or '-' }}</td>
                            <td>{{ bowl.ipl.bbm or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">4W</td>
                            <td>{{ bowl.test['4w'] or '-' }}</td>
                            <td>{{ bowl.odi['4w'] or '-' }}</td>
                            <td>{{ bowl.t20['4w'] or '-' }}</td>
                            <td>{{ bowl.ipl['4w'] or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">5W</td>
                            <td>{{ bowl.test['5w'] or '-' }}</td>
                            <td>{{ bowl.odi['5w'] or '-' }}</td>
                            <td>{{ bowl.t20['5w'] or '-' }}</td>
                            <td>{{ bowl.ipl['5w'] or '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">10W</td>
                            <td>{{ bowl.test['10w'] or '-' }}</td>
                            <td>{{ bowl.odi['10w'] or '-' }}</td>
                            <td>{{ bowl.t20['10w'] or '-' }}</td>
                            <td>{{ bowl.ipl['10w'] or '-' }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        {% endif %}
        {% endif %}
        
        {% if player.career_timeline %}
        <div class="player-stats-card">
            <h3>Career Timeline</h3>
            <div class="stats-table-wrapper">
                <table class="format-stats-table timeline-table">
                    <thead>
                        <tr>
                            <th>Format</th>
                            <th>Debut</th>
                            <th>Last Match</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for format, data in player.career_timeline.items() %}
                        <tr>
                            <td class="format-label">{{ format|upper }}</td>
                            <td>{{ data.debut or '-' }}</td>
                            <td>{{ data.last_match or '-' }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        {% endif %}
        
        {% if not player.profile_scraped %}
        <div class="profile-not-scraped">
            <p>Detailed stats not yet available. Profile needs to be scraped from admin panel.</p>
        </div>
        {% endif %}
    </div>
</section>
{% endblock %}
