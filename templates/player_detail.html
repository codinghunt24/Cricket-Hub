{% extends 'base.html' %}

{% block title %}{{ player.name }} - Profile, Stats, Records | Cricbuzz Live Score{% endblock %}

{% block meta_description %}{{ player.name }} cricket profile, career stats, batting and bowling records. {{ player.name }} plays for {% if player.team %}{{ player.team.name }}{% else %}International{% endif %}{% if player.role %} as {{ player.role }}{% endif %}. Get latest news and stats on Cricbuzz Live Score.{% endblock %}

{% block meta_keywords %}{{ player.name }}, {{ player.name }} stats, {{ player.name }} career, {{ player.name }} batting, {{ player.name }} bowling, {{ player.name }} profile, {% if player.team %}{{ player.team.name }}, {% endif %}cricket player{% endblock %}

{% block og_title %}{{ player.name }} - Profile & Stats{% endblock %}
{% block og_description %}{{ player.name }} cricket career stats, batting and bowling records{% endblock %}
{% block og_type %}profile{% endblock %}
{% block og_image %}{% if player.photo_url %}{{ player.photo_url }}{% else %}https://cricbuzz-live-score.com/static/og-image.png{% endif %}{% endblock %}

{% block schema %}
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Person",
    "name": "{{ player.name }}",
    "url": "https://cricbuzz-live-score.com/player/{{ player.slug or player.id }}",
    {% if player.photo_url %}
    "image": "{{ player.photo_url }}",
    {% endif %}
    "jobTitle": "Cricket Player",
    {% if player.team %}
    "memberOf": {
        "@type": "SportsTeam",
        "name": "{{ player.team.name }}"
    },
    {% endif %}
    "description": "{{ player.name }} is a cricket player{% if player.team %} who plays for {{ player.team.name }}{% endif %}{% if player.role %} as {{ player.role }}{% endif %}"
}
</script>
{% endblock %}

{% block content %}
<section class="player-detail-page">
    <div class="page-header">
        {% if player.team %}
        <a href="/team/{{ player.team.slug or player.team.id }}" class="back-link">&larr; Back to {{ player.team.name }}</a>
        {% else %}
        <a href="/teams" class="back-link">&larr; Back to Teams</a>
        {% endif %}
    </div>
    
    <div class="player-profile">
        <div class="player-profile-header">
            <div class="player-photo-large">
                {% if player.photo_url %}
                <img src="{{ player.photo_url }}" alt="{{ player.name }}" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                <div class="photo-placeholder-large" style="display:none;">{{ player.name[0] }}</div>
                {% else %}
                <div class="photo-placeholder-large">{{ player.name[0] }}</div>
                {% endif %}
            </div>
            <div class="player-profile-info">
                <h1 class="player-profile-name">{{ player.name }}</h1>
                <div class="player-info-badge">
                    {% if player.role %}
                    <span class="badge-item">{{ player.role }}</span>
                    <span class="badge-divider">|</span>
                    {% endif %}
                    {% if player.team %}
                    <span class="badge-item">{{ player.team.name }}</span>
                    {% if player.team.category %}
                    <span class="badge-divider">|</span>
                    <span class="badge-item">{{ player.team.category.name }}</span>
                    {% endif %}
                    {% endif %}
                </div>
            </div>
            <div class="player-flag-large">
                {% if player.team and player.team.flag_url %}
                <img src="{{ player.team.flag_url }}" alt="{{ player.team.name }}">
                {% endif %}
            </div>
        </div>
        
        <div class="player-about-card">
            <h3>About {{ player.name }}</h3>
            <p class="player-about-text">
                {{ player.name }} is a professional cricket player{% if player.team %} who represents {{ player.team.name }}{% if player.team.category %} in {{ player.team.category.name }} cricket{% endif %}{% endif %}{% if player.role %}, primarily known as a {{ player.role }}{% endif %}.
                {% if player.batting_style %}{{ player.name }} is a {{ player.batting_style }} batsman{% endif %}{% if player.bowling_style %} and bowls {{ player.bowling_style }}{% endif %}.
                {% if player.birth_place %}Born in {{ player.birth_place }}{% if player.born %} on {{ player.born }}{% endif %}, {{ player.name }} has established a notable career in cricket.{% endif %}
                {% if player.bat_matches and player.bat_matches|int > 0 %}
                In batting, {{ player.name }} has played {{ player.bat_matches }} matches, scoring {{ player.bat_runs or 0 }} runs{% if player.bat_highest %} with a highest score of {{ player.bat_highest }}{% endif %}{% if player.bat_average %} at an average of {{ player.bat_average }}{% endif %}.
                {% if player.bat_hundreds and player.bat_hundreds|int > 0 %}{{ player.name }} has scored {{ player.bat_hundreds }} centuries and {{ player.bat_fifties or 0 }} half-centuries.{% endif %}
                {% endif %}
                {% if player.bowl_wickets and player.bowl_wickets|int > 0 %}
                As a bowler, {{ player.name }} has taken {{ player.bowl_wickets }} wickets{% if player.bowl_best_innings %} with best bowling figures of {{ player.bowl_best_innings }}{% endif %}{% if player.bowl_average %} at an average of {{ player.bowl_average }}{% endif %}.
                {% endif %}
            </p>
        </div>
        
        <div class="player-details-card">
            <h3>Personal Information</h3>
            <div class="info-grid">
                {% if player.born %}
                <div class="info-item">
                    <span class="info-label">Born</span>
                    <span class="info-value">{{ player.born }}</span>
                </div>
                {% endif %}
                {% if player.birth_place %}
                <div class="info-item">
                    <span class="info-label">Birth Place</span>
                    <span class="info-value">{{ player.birth_place }}</span>
                </div>
                {% endif %}
                {% if player.nickname %}
                <div class="info-item">
                    <span class="info-label">Nickname</span>
                    <span class="info-value">{{ player.nickname }}</span>
                </div>
                {% endif %}
                {% if player.role %}
                <div class="info-item">
                    <span class="info-label">Role</span>
                    <span class="info-value">{{ player.role }}</span>
                </div>
                {% endif %}
                {% if player.batting_style %}
                <div class="info-item">
                    <span class="info-label">Batting Style</span>
                    <span class="info-value">{{ player.batting_style }}</span>
                </div>
                {% endif %}
                {% if player.bowling_style %}
                <div class="info-item">
                    <span class="info-label">Bowling Style</span>
                    <span class="info-value">{{ player.bowling_style }}</span>
                </div>
                {% endif %}
                {% if player.team %}
                <div class="info-item">
                    <span class="info-label">Team</span>
                    <span class="info-value">{{ player.team.name }}</span>
                </div>
                {% if player.team.category %}
                <div class="info-item">
                    <span class="info-label">Category</span>
                    <span class="info-value">{{ player.team.category.name }}</span>
                </div>
                {% endif %}
                {% endif %}
            </div>
        </div>
        
        <div class="career-stats-row">
        {% if player.batting_stats %}
        {% set bat = player.batting_stats %}
        {% if bat.Test or bat.ODI or bat.T20 or bat.IPL %}
        <div class="player-stats-card career-stat-half">
            <h3>Batting Career Summary</h3>
            <div class="stats-table-wrapper">
                <table class="format-stats-table">
                    <thead>
                        <tr>
                            <th></th>
                            <th>TEST</th>
                            <th>ODI</th>
                            <th>T20</th>
                            <th>IPL</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="stat-label">Matches</td>
                            <td>{{ bat.Test.matches if bat.Test else '-' }}</td>
                            <td>{{ bat.ODI.matches if bat.ODI else '-' }}</td>
                            <td>{{ bat.T20.matches if bat.T20 else '-' }}</td>
                            <td>{{ bat.IPL.matches if bat.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Innings</td>
                            <td>{{ bat.Test.innings if bat.Test else '-' }}</td>
                            <td>{{ bat.ODI.innings if bat.ODI else '-' }}</td>
                            <td>{{ bat.T20.innings if bat.T20 else '-' }}</td>
                            <td>{{ bat.IPL.innings if bat.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Runs</td>
                            <td>{{ bat.Test.runs if bat.Test else '-' }}</td>
                            <td>{{ bat.ODI.runs if bat.ODI else '-' }}</td>
                            <td>{{ bat.T20.runs if bat.T20 else '-' }}</td>
                            <td>{{ bat.IPL.runs if bat.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Balls</td>
                            <td>{{ bat.Test.balls if bat.Test else '-' }}</td>
                            <td>{{ bat.ODI.balls if bat.ODI else '-' }}</td>
                            <td>{{ bat.T20.balls if bat.T20 else '-' }}</td>
                            <td>{{ bat.IPL.balls if bat.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Highest</td>
                            <td>{{ bat.Test.highest if bat.Test else '-' }}</td>
                            <td>{{ bat.ODI.highest if bat.ODI else '-' }}</td>
                            <td>{{ bat.T20.highest if bat.T20 else '-' }}</td>
                            <td>{{ bat.IPL.highest if bat.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Average</td>
                            <td>{{ bat.Test.average if bat.Test else '-' }}</td>
                            <td>{{ bat.ODI.average if bat.ODI else '-' }}</td>
                            <td>{{ bat.T20.average if bat.T20 else '-' }}</td>
                            <td>{{ bat.IPL.average if bat.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Strike Rate</td>
                            <td>{{ bat.Test.sr if bat.Test else '-' }}</td>
                            <td>{{ bat.ODI.sr if bat.ODI else '-' }}</td>
                            <td>{{ bat.T20.sr if bat.T20 else '-' }}</td>
                            <td>{{ bat.IPL.sr if bat.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Not Outs</td>
                            <td>{{ bat.Test.not_out if bat.Test else '-' }}</td>
                            <td>{{ bat.ODI.not_out if bat.ODI else '-' }}</td>
                            <td>{{ bat.T20.not_out if bat.T20 else '-' }}</td>
                            <td>{{ bat.IPL.not_out if bat.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">4s</td>
                            <td>{{ bat.Test.fours if bat.Test else '-' }}</td>
                            <td>{{ bat.ODI.fours if bat.ODI else '-' }}</td>
                            <td>{{ bat.T20.fours if bat.T20 else '-' }}</td>
                            <td>{{ bat.IPL.fours if bat.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">6s</td>
                            <td>{{ bat.Test.sixes if bat.Test else '-' }}</td>
                            <td>{{ bat.ODI.sixes if bat.ODI else '-' }}</td>
                            <td>{{ bat.T20.sixes if bat.T20 else '-' }}</td>
                            <td>{{ bat.IPL.sixes if bat.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Ducks</td>
                            <td>{{ bat.Test.ducks if bat.Test else '-' }}</td>
                            <td>{{ bat.ODI.ducks if bat.ODI else '-' }}</td>
                            <td>{{ bat.T20.ducks if bat.T20 else '-' }}</td>
                            <td>{{ bat.IPL.ducks if bat.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">50s</td>
                            <td>{{ bat.Test['50s'] if bat.Test else '-' }}</td>
                            <td>{{ bat.ODI['50s'] if bat.ODI else '-' }}</td>
                            <td>{{ bat.T20['50s'] if bat.T20 else '-' }}</td>
                            <td>{{ bat.IPL['50s'] if bat.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">100s</td>
                            <td>{{ bat.Test['100s'] if bat.Test else '-' }}</td>
                            <td>{{ bat.ODI['100s'] if bat.ODI else '-' }}</td>
                            <td>{{ bat.T20['100s'] if bat.T20 else '-' }}</td>
                            <td>{{ bat.IPL['100s'] if bat.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">200s</td>
                            <td>{{ bat.Test['200s'] if bat.Test else '-' }}</td>
                            <td>{{ bat.ODI['200s'] if bat.ODI else '-' }}</td>
                            <td>{{ bat.T20['200s'] if bat.T20 else '-' }}</td>
                            <td>{{ bat.IPL['200s'] if bat.IPL else '-' }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        {% endif %}
        {% endif %}
        
        {% if player.bowling_stats %}
        {% set bowl = player.bowling_stats %}
        {% if bowl.Test or bowl.ODI or bowl.T20 or bowl.IPL %}
        <div class="player-stats-card career-stat-half">
            <h3>Bowling Career Summary</h3>
            <div class="stats-table-wrapper">
                <table class="format-stats-table">
                    <thead>
                        <tr>
                            <th></th>
                            <th>TEST</th>
                            <th>ODI</th>
                            <th>T20</th>
                            <th>IPL</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="stat-label">Matches</td>
                            <td>{{ bowl.Test.matches if bowl.Test else '-' }}</td>
                            <td>{{ bowl.ODI.matches if bowl.ODI else '-' }}</td>
                            <td>{{ bowl.T20.matches if bowl.T20 else '-' }}</td>
                            <td>{{ bowl.IPL.matches if bowl.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Innings</td>
                            <td>{{ bowl.Test.innings if bowl.Test else '-' }}</td>
                            <td>{{ bowl.ODI.innings if bowl.ODI else '-' }}</td>
                            <td>{{ bowl.T20.innings if bowl.T20 else '-' }}</td>
                            <td>{{ bowl.IPL.innings if bowl.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Balls</td>
                            <td>{{ bowl.Test.balls if bowl.Test else '-' }}</td>
                            <td>{{ bowl.ODI.balls if bowl.ODI else '-' }}</td>
                            <td>{{ bowl.T20.balls if bowl.T20 else '-' }}</td>
                            <td>{{ bowl.IPL.balls if bowl.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Runs</td>
                            <td>{{ bowl.Test.runs if bowl.Test else '-' }}</td>
                            <td>{{ bowl.ODI.runs if bowl.ODI else '-' }}</td>
                            <td>{{ bowl.T20.runs if bowl.T20 else '-' }}</td>
                            <td>{{ bowl.IPL.runs if bowl.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Maidens</td>
                            <td>{{ bowl.Test.maidens if bowl.Test else '-' }}</td>
                            <td>{{ bowl.ODI.maidens if bowl.ODI else '-' }}</td>
                            <td>{{ bowl.T20.maidens if bowl.T20 else '-' }}</td>
                            <td>{{ bowl.IPL.maidens if bowl.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Wickets</td>
                            <td>{{ bowl.Test.wickets if bowl.Test else '-' }}</td>
                            <td>{{ bowl.ODI.wickets if bowl.ODI else '-' }}</td>
                            <td>{{ bowl.T20.wickets if bowl.T20 else '-' }}</td>
                            <td>{{ bowl.IPL.wickets if bowl.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Average</td>
                            <td>{{ bowl.Test.avg if bowl.Test else '-' }}</td>
                            <td>{{ bowl.ODI.avg if bowl.ODI else '-' }}</td>
                            <td>{{ bowl.T20.avg if bowl.T20 else '-' }}</td>
                            <td>{{ bowl.IPL.avg if bowl.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Economy</td>
                            <td>{{ bowl.Test.eco if bowl.Test else '-' }}</td>
                            <td>{{ bowl.ODI.eco if bowl.ODI else '-' }}</td>
                            <td>{{ bowl.T20.eco if bowl.T20 else '-' }}</td>
                            <td>{{ bowl.IPL.eco if bowl.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">Strike Rate</td>
                            <td>{{ bowl.Test.sr if bowl.Test else '-' }}</td>
                            <td>{{ bowl.ODI.sr if bowl.ODI else '-' }}</td>
                            <td>{{ bowl.T20.sr if bowl.T20 else '-' }}</td>
                            <td>{{ bowl.IPL.sr if bowl.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">BBI</td>
                            <td>{{ bowl.Test.bbi if bowl.Test else '-' }}</td>
                            <td>{{ bowl.ODI.bbi if bowl.ODI else '-' }}</td>
                            <td>{{ bowl.T20.bbi if bowl.T20 else '-' }}</td>
                            <td>{{ bowl.IPL.bbi if bowl.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">BBM</td>
                            <td>{{ bowl.Test.bbm if bowl.Test else '-' }}</td>
                            <td>{{ bowl.ODI.bbm if bowl.ODI else '-' }}</td>
                            <td>{{ bowl.T20.bbm if bowl.T20 else '-' }}</td>
                            <td>{{ bowl.IPL.bbm if bowl.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">4W</td>
                            <td>{{ bowl.Test['4w'] if bowl.Test else '-' }}</td>
                            <td>{{ bowl.ODI['4w'] if bowl.ODI else '-' }}</td>
                            <td>{{ bowl.T20['4w'] if bowl.T20 else '-' }}</td>
                            <td>{{ bowl.IPL['4w'] if bowl.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">5W</td>
                            <td>{{ bowl.Test['5w'] if bowl.Test else '-' }}</td>
                            <td>{{ bowl.ODI['5w'] if bowl.ODI else '-' }}</td>
                            <td>{{ bowl.T20['5w'] if bowl.T20 else '-' }}</td>
                            <td>{{ bowl.IPL['5w'] if bowl.IPL else '-' }}</td>
                        </tr>
                        <tr>
                            <td class="stat-label">10W</td>
                            <td>{{ bowl.Test['10w'] if bowl.Test else '-' }}</td>
                            <td>{{ bowl.ODI['10w'] if bowl.ODI else '-' }}</td>
                            <td>{{ bowl.T20['10w'] if bowl.T20 else '-' }}</td>
                            <td>{{ bowl.IPL['10w'] if bowl.IPL else '-' }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        {% endif %}
        {% endif %}
        </div>
        
        {% if player.career_timeline and player.career_timeline|length > 0 %}
        <div class="player-stats-card">
            <h3>Career Timeline</h3>
            <div class="stats-table-wrapper">
                <table class="format-stats-table timeline-table">
                    <thead>
                        <tr>
                            <th>Format</th>
                            <th>Debut</th>
                            <th>Last Match</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for entry in player.career_timeline %}
                        <tr>
                            <td class="format-label">{{ entry.format }}</td>
                            <td>
                                {% if entry.debut %}
                                vs {{ entry.debut.opponent }}, {{ entry.debut.date }}, {{ entry.debut.venue }}
                                {% else %}
                                -
                                {% endif %}
                            </td>
                            <td>
                                {% if entry.last_match %}
                                vs {{ entry.last_match.opponent }}, {{ entry.last_match.date }}, {{ entry.last_match.venue }}
                                {% else %}
                                -
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        {% endif %}
        
        {% if not player.profile_scraped %}
        <div class="profile-not-scraped">
            <p>Detailed stats not yet available. Profile needs to be scraped from admin panel.</p>
        </div>
        {% endif %}
    </div>
</section>
{% endblock %}
